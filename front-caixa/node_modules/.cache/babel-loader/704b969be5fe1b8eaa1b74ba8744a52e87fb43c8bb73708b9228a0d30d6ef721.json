{"ast":null,"code":"export default {\n  name: \"registro\",\n  data() {\n    return {\n      descricaoVenda: \"\",\n      valorVenda: 0,\n      // Em centavos\n      valorPago: 0 // Em centavos\n    };\n  },\n  computed: {\n    valorVendaFormatado: {\n      get() {\n        return this.formatarNumero(this.valorVenda);\n      },\n      set(valor) {\n        this.valorVenda = this.desformatarMoeda(valor);\n      }\n    },\n    valorPagoFormatado: {\n      get() {\n        return this.formatarNumero(this.valorPago);\n      },\n      set(valor) {\n        this.valorPago = this.desformatarMoeda(valor);\n      }\n    },\n    troco() {\n      const resultado = this.valorPago - this.valorVenda;\n      return resultado > 0 ? resultado : 0;\n    },\n    trocoFormatado() {\n      return this.formatarNumero(this.troco);\n    }\n  },\n  methods: {\n    formatarNumero(valor) {\n      return (valor / 100).toLocaleString(\"pt-BR\", {\n        style: \"currency\",\n        currency: \"BRL\"\n      });\n    },\n    desformatarMoeda(valor) {\n      return Number(valor.replace(/[^0-9]/g, ''));\n    },\n    async finalizarVenda() {\n      // Validação simples dos campos\n      if (this.descricaoVenda.trim() === \"\" || !this.valorVenda || this.valorVenda <= 0 || !this.valorPago || this.valorPago <= 0 || this.valorPago < this.valorVenda) {\n        alert(\"FORNEÇA TODOS OS DADOS DA COMPRA CORRETAMENTE\");\n        return; // para aqui se não passar na validação\n      }\n\n      // Montando o objeto para enviar\n      const dados = {\n        desc: this.descricaoVenda,\n        valorVenda: this.valorVendaFormatado,\n        opcoes: this.$refs.opcoes.value\n      };\n      try {\n        const res = await fetch('http://localhost:3000/finalizar', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(dados)\n        });\n        if (!res.ok) {\n          throw new Error('Erro na resposta do servidor');\n        }\n        const texto = await res.text();\n        alert(texto);\n\n        // Limpando os campos só após o envio com sucesso\n        this.descricaoVenda = \"\";\n        this.valorVenda = \"\";\n        this.valorPago = \"\";\n      } catch (error) {\n        alert('Erro ao enviar venda');\n        console.error(error);\n      }\n    }\n  }\n};","map":{"version":3,"names":["name","data","descricaoVenda","valorVenda","valorPago","computed","valorVendaFormatado","get","formatarNumero","set","valor","desformatarMoeda","valorPagoFormatado","troco","resultado","trocoFormatado","methods","toLocaleString","style","currency","Number","replace","finalizarVenda","trim","alert","dados","desc","opcoes","$refs","value","res","fetch","method","headers","body","JSON","stringify","ok","Error","texto","text","error","console"],"sources":["C:\\Users\\eujun\\Desktop\\Sistema de Caixa\\front-caixa\\src\\components\\registro.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <img src=\"../assets/img/img inicial.png\" alt=\"operando o caixa\">\r\n    <main class=\"container\">\r\n    <form action=\"/finalizar\" method=\"post\">\r\n    <section id=\"descricao\"> \r\n      <h2>Descrição da Venda</h2>\r\n      <input type=\"text\" required maxlength=\"100\" minlength=\"30\" v-model=\"descricaoVenda\" name=\"desc\" />\r\n    </section>\r\n\r\n    <section id=\"valorVenda\">\r\n      <h2>VALOR DA VENDA</h2>\r\n      <input type=\"text\" v-model=\"valorVendaFormatado\" placeholder=\"R$ 0,00\" name=\"valorVenda\"/>\r\n    </section>\r\n\r\n    <section id=\"formaPagamento\">\r\n    <label for=\"opcoes\">FORMA DE PAGAMENTO</label>\r\n    <select name=\"opcoes\" id=\"opcoes\" ref=\"opcoes\" >\r\n      <option value=\"DINHEIRO\" selected>DINHEIRO</option>\r\n      <option value=\"CARTÃO DE CRÉDITO\">CARTÃO DE CRÉDITO</option>\r\n      <option value=\"CARTÃO DE DÉDITO\">CARTÃO DE DÉDITO</option>\r\n      <option value=\"PIX\">PIX</option>\r\n    </select>\r\n    </section>\r\n\r\n    <section id=\"valorPago\">\r\n      <h2>VALOR PAGO</h2>\r\n      <input type=\"text\" v-model=\"valorPagoFormatado\" placeholder=\"R$ 0,00\"  name=\"valorPago\"/>\r\n    </section>\r\n\r\n    <section id=\"troco\">\r\n      <h2>TROCO</h2>\r\n      <input type=\"text\" :value=\"trocoFormatado\" disabled />\r\n    </section>\r\n\r\n    <section id=\"finalizar\">\r\n      <button  type=\"button\" class=\"btn btn-success\" id=\"btn\" @click=\"finalizarVenda\">FINALIZAR VENDA</button>\r\n     \r\n    </section>\r\n    </form>\r\n  </main>\r\n  </div>\r\n \r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"registro\",\r\n  data() {\r\n    return {\r\n      descricaoVenda: \"\",\r\n      valorVenda: 0, // Em centavos\r\n      valorPago: 0,  // Em centavos\r\n    };\r\n  },\r\n  computed: {\r\n    valorVendaFormatado: {\r\n      get() {\r\n        return this.formatarNumero(this.valorVenda);\r\n      },\r\n      set(valor) {\r\n        this.valorVenda = this.desformatarMoeda(valor);\r\n      },\r\n    },\r\n    valorPagoFormatado: {\r\n      get() {\r\n        return this.formatarNumero(this.valorPago);\r\n      },\r\n      set(valor) {\r\n        this.valorPago = this.desformatarMoeda(valor);\r\n      },\r\n    },\r\n    troco() {\r\n      const resultado = this.valorPago - this.valorVenda;\r\n      return resultado > 0 ? resultado : 0;\r\n    },\r\n    trocoFormatado() {\r\n      return this.formatarNumero(this.troco);\r\n    },\r\n  },\r\n  methods: {\r\n    formatarNumero(valor) {\r\n      return (valor / 100).toLocaleString(\"pt-BR\", {\r\n        style: \"currency\",\r\n        currency: \"BRL\",\r\n      });\r\n    },\r\n    desformatarMoeda(valor) {\r\n      return Number(valor.replace(/[^0-9]/g, ''));\r\n    },\r\n    async finalizarVenda() {\r\n      // Validação simples dos campos\r\n      if (\r\n        this.descricaoVenda.trim() === \"\" ||\r\n        !this.valorVenda ||\r\n        this.valorVenda <= 0 ||\r\n        !this.valorPago ||\r\n        this.valorPago <= 0 ||\r\n        this.valorPago < this.valorVenda\r\n      ) {\r\n        alert(\"FORNEÇA TODOS OS DADOS DA COMPRA CORRETAMENTE\");\r\n        return; // para aqui se não passar na validação\r\n      }\r\n\r\n      // Montando o objeto para enviar\r\n      const dados = {\r\n        desc: this.descricaoVenda,\r\n        valorVenda: this.valorVendaFormatado,\r\n        opcoes: this.$refs.opcoes.value\r\n      };\r\n\r\n      try {\r\n        const res = await fetch('http://localhost:3000/finalizar', {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify(dados)\r\n        });\r\n\r\n        if (!res.ok) {\r\n          throw new Error('Erro na resposta do servidor');\r\n        }\r\n\r\n        const texto = await res.text();\r\n        alert(texto);\r\n\r\n        // Limpando os campos só após o envio com sucesso\r\n        this.descricaoVenda = \"\";\r\n        this.valorVenda = \"\";\r\n        this.valorPago = \"\";\r\n\r\n      } catch (error) {\r\n        alert('Erro ao enviar venda');\r\n        console.error(error);\r\n      }\r\n    }\r\n  }\r\n};\r\n\r\n  \r\n\r\n\r\n    \r\n</script>\r\n\r\n\r\n\r\n<style scoped>\r\n\r\nmain {\r\n background-color:aqua;\r\n  margin-top: 10%;\r\n  width: 500px;\r\n  height: 700px;\r\n  border-radius: 10%;\r\n  margin-left: 50%;\r\n\r\n}\r\n\r\nimg{\r\n  position: fixed;\r\n  top: 10%;\r\n  left: 5%;\r\n  bottom: 10%;\r\n  width:600px;\r\n  height: 800px;\r\n}\r\n\r\nsection {\r\n  margin-left: 15%;\r\n  margin-top: 4%;\r\n}\r\nlabel,h2{\r\n  font-size: 2em;\r\n  font-weight: bold;\r\n\r\n}\r\ninput{\r\n  color: red;\r\n  height: 50px;\r\n  font-size: 2em;\r\n  border: none;\r\n  outline-color: red;\r\n}\r\nselect{\r\n  font-size: 1.5em;\r\n  color: red;\r\n  font-weight: bold;\r\n  width: 300px;\r\n}\r\n\r\n\r\n#desc {\r\n  width: 100%;\r\n  padding-left: 10px;\r\n  border-radius: 5px;\r\n}\r\n#finalizar{\r\n  width: 100%;\r\n  margin-top: 10%;\r\n  margin-left: 20%;\r\n}\r\n\r\n#btn{\r\n  width: 300px;\r\n  height: 80px;\r\n  font-size: 2em;\r\n  text-align: center;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}